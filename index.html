<!DOCTYPE html>
<html>
    <head>

        <!-- script de A-Frane version1 1.0.0 -->
        <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
        <!-- script de AR.JS con soporte de marker + location -->
        <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
       
        <script>
            var detectedQR = false;

            AFRAME.registerComponent("markercomp", {
                init: function () {
                    var marker = document.querySelector("#marker");
                    marker.addEventListener("markerFound", function () {
                            console.log("MARKER DETECTED");
                            if(!detectedQR){
                                displayEntity("#pallet","#marker");
                                detectedQR = true;
                            }
                    });

                    marker.addEventListener("markerLost", function () {
                            console.log("MARKER LOST");
                            removeEntity("#pallet");
                    });
                
            
                }
            });

            function displayEntity(e_id,m_id) {

                console.log("AYAYAYAYYA");
                
                var el = document.querySelector(e_id);
                el.setAttribute("visible", true);
                

                var mel = document.querySelector(m_id);
                var m_position = mel.getAttribute("position");
                el.setAttribute("position",{x:m_position.x,y:m_position.y,z:m_position.z});
                
            }
            

           function removeEntity(e_id) {
               // var el = document.querySelector(e_id);
               // el.setAttribute("visible", false);           
               // console.log("NONONONONO" );
            }

        </script>

    </head>
    <body style="margin : 0px; overflow: hidden;">

        
        <a-scene embedded arjs="debugUIEnabled: true" trackingMethod= "best" vr-mode-ui="enabled: false">        
            
            <a-assets>
                <a-asset-item id="3dmodel" src="scene.gltf"></a-asset-item>
                <img id="logo_img" src="logo_telecmotica.png">
            </a-assets>
            
            
            <a-entity gltf-model="#3dmodel" id="pallet"
            scale="0.1 0.1 0.1"
            rotation="90,0,0"
            visible="false">
                <a-image id="logo"
                position="0 3 0"
                scale="1 1 2"
                animation="property: rotation; dur: 15000; to: 0 360 0; loop: true"
                src="#logo_img">
                </a-image>
            </a-entity>
        
        
        <a-marker markercomp
        markerhandler emitevents="true"
        id="marker" 
        preset="custom" type="pattern" url="custom.patt">
        </a-marker>
        
        <a-entity camera></a-entity>
        
        </a-scene>

    </body>
</html>